# Render.com Deployment Guide

This guide ensures your articles created in GitHub Codespaces will be properly displayed on your Render.com deployment.

## Pre-Deployment Checklist

### 1. Environment Variables
Ensure these environment variables are set in your Render.com dashboard:

- `NEWS_API_KEY`: Your NewsAPI key (set as secret)
- `SECRET_KEY`: Auto-generated by Render
- `DATABASE_URL`: Auto-configured by Render PostgreSQL
- `FLASK_ENV`: Set to `production`

### 2. Database Setup
The deployment includes automatic database initialization and seeding:

- **Tables**: Automatically created on first deployment
- **Sample Data**: Categories and articles are seeded if database is empty
- **Persistence**: All data persists between deployments

## Deployment Process

### 1. Connect Repository
1. Go to Render.com dashboard
2. Click "New" → "Web Service"
3. Connect your GitHub repository
4. Select the `News` repository

### 2. Configure Service
Use these settings:
- **Name**: `news-app` (or your preferred name)
- **Environment**: `Python`
- **Build Command**: `pip install -r requirements.txt && python deploy_setup.py`
- **Start Command**: `gunicorn news_app:app --timeout 120 --workers 1 --bind 0.0.0.0:$PORT`

### 3. Database Configuration
1. Create a PostgreSQL database in Render
2. Name it `news-db`
3. The `DATABASE_URL` will be automatically configured

### 4. Deploy
Click "Create Web Service" to start deployment.

## Post-Deployment Verification

### 1. Check Application Health
Visit your Render.com URL and verify:
- ✅ Home page loads correctly
- ✅ Articles page shows seeded articles
- ✅ Categories are properly displayed
- ✅ Admin dashboard is accessible
- ✅ Media management works (upload/view)
- ✅ Category management functions

### 2. Verify Database Content
The deployment automatically creates:
- **6 Categories**: Technology, World, Local, Business, Sports, Entertainment
- **4 Sample Articles**: Welcome message, tech trends, economic outlook, community events
- **Media System**: Upload directory and database tables ready

### 3. Test Full Management System
1. Go to `/manage` (admin dashboard)
2. **Articles**: Create, edit, delete articles
3. **Categories**: Add new categories with descriptions
4. **Media**: Upload images and files
5. Verify all changes persist and display correctly

## File Structure for Deployment

```
News/
├── deploy_setup.py          # Deployment initialization script
├── render.yaml             # Render.com configuration
├── Procfile               # Alternative deployment config
├── requirements.txt       # Python dependencies
├── app.py                # Application entry point
└── news_app/             # Main application package
    ├── __init__.py       # App factory with database setup
    ├── seed.py          # Database seeding script
    └── ...              # Other application files
```

## Key Features for Production

### 1. Database Persistence
- Uses PostgreSQL on Render.com for production
- Automatic table creation on first run
- Data persists between deployments

### 2. Media Upload Support
- Configured persistent disk storage for uploaded images
- 1GB storage allocation on Render.com
- Files persist between deployments
- Automatic upload directory creation
- Support for images, documents, and media files

### 3. Category Management
- Pre-seeded with 6 comprehensive categories
- Support for category descriptions
- Easy category creation and editing
- Articles automatically organized by category

### 3. Error Handling
- Graceful handling of missing data
- Automatic database recovery
- Comprehensive logging

## Troubleshooting

### Articles Not Showing
1. Check deployment logs for database errors
2. Verify `DATABASE_URL` is properly set
3. Ensure `deploy_setup.py` ran successfully during build

### Categories Not Working
1. Verify category table was created
2. Check if seeding completed successfully
3. Test category creation in admin dashboard

### Media Upload Problems
1. Verify disk storage is properly mounted at `/opt/render/project/src/static/uploads`
2. Check file permissions and directory exists
3. Ensure upload directory has `.gitkeep` file
4. Verify media table exists in database

### Database Issues
1. Check PostgreSQL database is running
2. Verify connection string format
3. Review application logs for SQL errors
4. Ensure all tables (article, category, media) are created

## Manual Database Reset (if needed)

If you need to reset the database:

1. Delete the PostgreSQL database in Render dashboard
2. Create a new one with the same name
3. Redeploy the application
4. The `deploy_setup.py` script will reinitialize everything

## Monitoring

Monitor your deployment:
- **Logs**: Available in Render dashboard
- **Metrics**: CPU, memory, and request metrics
- **Health**: Application responds to health checks

## Support

If you encounter issues:
1. Check Render deployment logs
2. Verify all environment variables are set
3. Ensure database is properly connected
4. Review the application logs for specific errors

Your articles created in GitHub Codespaces will be automatically available after successful deployment!